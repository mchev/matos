import{k as $,q as b,H as D,u as H,c as L,w as a,a as e,g as u,o as d,b as r,d as s,l as N,e as m,F as M,r as S,t as l,h as w,f as R,i as k}from"./app-Cgyqco5e.js";import{_ as c}from"./index-CfrgMgmj.js";import{_ as B}from"./Textarea.vue_vue_type_script_setup_true_lang-Na6mNp-F.js";import{_ as C,a as q}from"./CardContent.vue_vue_type_script_setup_true_lang-VjQfOjPI.js";import{_ as F,a as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-B2nn949D.js";import{_ as Q}from"./Separator.vue_vue_type_script_setup_true_lang-Ywayg7H4.js";import{_ as J,a as Z}from"./DialogContent.vue_vue_type_script_setup_true_lang-CLzAqvnw.js";import{_ as G,a as K}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C0yVyRvA.js";import{_ as O,a as W}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Ez63R66Q.js";import{T as X,i as Y,t as _}from"./FlashMessage-BkxJg_3D.js";import{_ as ee}from"./PublicLayout-BMcaWCS0.js";import{c as g}from"./createLucideIcon-DwRVYtr5.js";import{P as te}from"./UserDropdown-Z_lunlqk.js";import{T as se}from"./triangle-alert-D-D3yUkN.js";import{U as re}from"./users-DMGSewa1.js";import{S as ae}from"./shield-BHlX9to5.js";import{C as ne}from"./circle-alert-u1_U4Jms.js";import"./useForwardExpose-43cBTImL.js";import"./Separator-DYSKz8jW.js";import"./Teleport-BUs9OIgV.js";import"./DialogPortal-DebP4ZVQ.js";import"./DialogDescription-BYzOpbSc.js";import"./DialogTitle-CLvWREPx.js";import"./index-B_Hr3V4-.js";import"./package-DPeVUDVU.js";import"./loader-circle-BHkOripO.js";import"./Input.vue_vue_type_script_setup_true_lang-DX9VCuGY.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=g("CameraIcon",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=g("CreditCardIcon",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=g("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=g("MinusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}]]),ue={class:"max-w-7xl mx-auto py-6"},me={key:0,class:"flex flex-col items-center justify-center py-12"},ce={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},pe={class:"lg:col-span-2 space-y-6"},fe={class:"uppercase font-medium"},ve={class:"flex flex-wrap gap-6"},_e={class:"relative"},xe=["src","alt"],ye={key:1,class:"w-12 h-12 lg:w-32 lg:h-32 bg-muted rounded-lg flex items-center justify-center"},ge={class:"flex-1"},he={class:"text-lg font-semibold mb-2"},be={class:"space-y-2 text-sm text-muted-foreground"},we={class:"space-y-1"},ke={class:"flex items-center gap-2 mt-1"},Ce={class:"w-8 text-center"},qe={key:0},ze={class:"lg:text-right space-y-2"},je={class:"text-lg font-semibold"},Ve={class:"text-sm"},$e={key:0,class:"text-sm text-muted-foreground"},Le={class:"flex justify-between pt-4 border-t"},Me={class:"font-medium"},Se={class:"text-right"},Fe={class:"font-semibold"},Te={key:0,class:"text-sm text-muted-foreground"},Ee={class:"lg:col-span-1 space-y-6"},Ie={class:"space-y-2"},Pe={class:"flex justify-between"},Ue={class:"flex justify-between"},Ae={class:"space-y-4 py-4"},De={class:"flex gap-3"},He={class:"flex-shrink-0 w-6 h-6 rounded-full bg-destructive/10 flex items-center justify-center text-destructive"},Ne={class:"flex gap-3"},Re={class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary"},Be={class:"flex gap-3"},Qe={class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary"},Je={class:"flex gap-3"},Ze={class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary"},Ge={class:"flex gap-3"},Ke={class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary"},Oe={class:"flex gap-3"},We={class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary"},zt={__name:"Show",setup(Xe){const f=$(!1),v=$(!1),x=b(()=>D().props.items),y=H({message:""}),E=()=>{y.post(route("app.organizations.reservations.in.store"),{onSuccess:()=>{v.value=!1}})},z=i=>new Date(i).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),p=i=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(i),I=b(()=>{var i;return((i=x.value)==null?void 0:i.reduce((t,o)=>t+o.total,0))??0}),P=b(()=>{var i;return((i=x.value)==null?void 0:i.reduce((t,o)=>t+o.deposit,0))??0}),h=async i=>{if(!f.value){f.value=!0;try{await i()}finally{f.value=!1}}},j=(i,t)=>{t<1||h(()=>k.put(route("carts.update",i.equipment.id),{quantity:t,rental_start:i.rental_start,rental_end:i.rental_end},{preserveScroll:!0,only:["items"],onError:()=>{_("Erreur",{description:"Une erreur s'est produite lors de la mise à jour de la quantité.",variant:"destructive"})}}))},U=i=>{confirm("Voulez-vous vraiment retirer cet article du camion ?")&&h(()=>k.delete(route("carts.remove",i.equipment.id),{data:{rental_start:i.rental_start,rental_end:i.rental_end}},{preserveScroll:!0,onSuccess:()=>{_("Article supprimé",{description:"L'article a été retiré de votre camion."})},onError:()=>{_("Erreur",{description:"Une erreur s'est produite lors de la suppression de l'article.",variant:"destructive"})}}))},A=()=>{confirm("Voulez-vous vraiment vider votre camion ?")&&h(()=>k.delete(route("carts.clear"),{onSuccess:()=>{_("Camion vidé",{description:"Tous les articles ont été retirés de votre camion."})},onError:()=>{_("Erreur",{description:"Une erreur s'est produite lors du vidage du camion.",variant:"destructive"})}}))};return(i,t)=>(d(),L(ee,{title:"Mon camion",description:"Vérifier le chargement avant de confirmer votre demande"},{header:a(()=>[...t[4]||(t[4]=[e("div",{class:"max-w-7xl mx-auto"},[e("h1",{class:"text-xl font-semibold"},"Mon camion"),e("p",{class:"text-sm text-muted-foreground"}," Vérifiez bien les dates et les quantités avant de confirmer votre demande. ")],-1)])]),default:a(()=>[e("div",ue,[x.value.length===0?(d(),u("div",me,[r(s(X),{class:"h-16 w-16 text-muted-foreground mb-4"}),t[6]||(t[6]=e("h2",{class:"text-2xl font-semibold mb-2"},"Votre camion est vide",-1)),t[7]||(t[7]=e("p",{class:"text-muted-foreground mb-6"},"Ajoutez du matériel à votre camion pour commencer",-1)),r(s(c),{asChild:""},{default:a(()=>[r(s(N),{href:i.route("home")},{default:a(()=>[...t[5]||(t[5]=[m(" Parcourir le matériel disponible ",-1)])]),_:1},8,["href"])]),_:1})])):(d(),u("div",ce,[e("div",pe,[(d(!0),u(M,null,S(x.value,o=>(d(),u("div",{key:o.organization.id,class:"space-y-4"},[r(s(C),{class:"bg-secondary/50"},{default:a(()=>[r(s(F),null,{default:a(()=>[r(s(T),null,{default:a(()=>[e("span",fe,l(o.organization.name),1)]),_:2},1024)]),_:2},1024),r(s(q),{class:"space-y-4"},{default:a(()=>[(d(!0),u(M,null,S(o.items,n=>(d(),L(s(C),{key:n.equipment.id,class:"group"},{default:a(()=>[r(s(q),{class:"px-4"},{default:a(()=>[e("div",ve,[e("div",_e,[n.image?(d(),u("img",{key:0,src:n.image,alt:n.equipment.name,class:"w-12 h-12 lg:w-32 lg:h-32 object-cover rounded-lg"},null,8,xe)):(d(),u("div",ye,[r(s(ie),{class:"h-10 w-10 text-muted-foreground"})]))]),e("div",ge,[e("h3",he,l(n.equipment.name),1),e("div",be,[e("p",null," du "+l(z(n.rental_start))+" au "+l(z(n.rental_end)),1),e("div",we,[t[8]||(t[8]=e("span",{class:"font-medium"},"Quantité:",-1)),e("div",ke,[r(s(c),{variant:"outline",size:"icon",onClick:V=>j(n,n.quantity-1),disabled:n.quantity<=1,class:"transition-opacity"},{default:a(()=>[r(s(de),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"]),e("span",Ce,l(n.quantity),1),r(s(c),{variant:"outline",size:"icon",onClick:V=>j(n,n.quantity+1),class:"transition-opacity",disabled:n.quantity>=n.quantityAvailable},{default:a(()=>[r(s(te),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),n.notes?(d(),u("p",qe,[t[9]||(t[9]=e("span",{class:"font-medium"},"Notes:",-1)),t[10]||(t[10]=e("br",null,null,-1)),m(" "+l(n.notes),1)])):w("",!0)])]),e("div",ze,[e("p",je,l(p(n.total)),1),e("p",Ve,l(p(n.price))+" x "+l(n.days)+" jours ",1),n.equipment.requires_deposit?(d(),u("p",$e," Caution: "+l(p(n.equipment.deposit_amount*n.quantity)),1)):w("",!0),r(s(c),{variant:"ghost",class:"text-destructive",size:"sm",onClick:V=>U(n)},{default:a(()=>[r(s(Y),{class:"h-4 w-4"}),t[11]||(t[11]=m(" Retirer ",-1))]),_:1},8,["onClick"])])])]),_:2},1024)]),_:2},1024))),128)),e("div",Le,[e("span",Me,"Total pour "+l(o.organization.name),1),e("div",Se,[e("p",Fe,l(p(o.total)),1),o.deposit>0?(d(),u("p",Te," Caution: "+l(p(o.deposit)),1)):w("",!0)])])]),_:2},1024)]),_:2},1024)]))),128))]),e("div",Ee,[r(s(C),null,{default:a(()=>[r(s(F),null,{default:a(()=>[r(s(T),null,{default:a(()=>[...t[12]||(t[12]=[m("Récapitulatif de la réservation",-1)])]),_:1})]),_:1}),r(s(q),{class:"space-y-4"},{default:a(()=>[e("div",Ie,[e("div",Pe,[t[13]||(t[13]=e("span",null,"Coût de location",-1)),e("span",null,l(p(I.value)),1)]),e("div",Ue,[t[14]||(t[14]=e("span",null,"Caution totale",-1)),e("span",null,l(p(P.value)),1)]),r(s(Q)),t[15]||(t[15]=e("p",{class:"text-sm text-muted-foreground"}," La caution sera à régler directement avec le propriétaire lors de la remise du matériel. ",-1))]),t[18]||(t[18]=e("div",{class:"space-y-2"},[e("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg border border-border"},[e("h4",{class:"font-medium mb-3 flex items-center gap-2"}," Comment fonctionne la réservation ? "),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex gap-3"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary font-medium"},"1"),e("p",null,'Vous notifiez les organisations propriétaires des équipements sélectionnés en cliquant sur le bouton "Confirmer ma demande".')]),e("div",{class:"flex gap-3"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary font-medium"},"2"),e("p",null,"Les propriétaires valident ou refusent votre demande. Laissez-leur un peu de temps pour répondre.")]),e("div",{class:"flex gap-3"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary font-medium"},"3"),e("p",null,"Vous recevez un email de chaque propriétaire avec leurs coordonnées pour finaliser la réservation si elle est acceptée. Vous recevez également un email si la réservation est refusée.")])])])],-1)),r(s(c),{class:"w-full",disabled:f.value,onClick:t[0]||(t[0]=o=>v.value=!0)},{default:a(()=>[...t[16]||(t[16]=[m(" Confirmer ma demande ",-1)])]),_:1},8,["disabled"]),r(s(c),{variant:"destructive",onClick:A,class:"w-full",disabled:f.value},{default:a(()=>[...t[17]||(t[17]=[m(" Vider le camion ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}),r(s(J),{open:v.value,"onUpdate:open":t[3]||(t[3]=o=>v.value=o)},{default:a(()=>[r(s(Z),{class:"sm:max-w-[600px]"},{default:a(()=>[r(s(O),null,{default:a(()=>[r(s(W),null,{default:a(()=>[...t[19]||(t[19]=[m("Confirmation de votre demande",-1)])]),_:1}),r(s(G),null,{default:a(()=>[...t[20]||(t[20]=[m(" Veuillez prendre connaissance des informations importantes avant de confirmer votre demande. ",-1)])]),_:1})]),_:1}),e("div",Ae,[e("div",De,[e("div",He,[r(s(se),{class:"h-4 w-4"})]),t[21]||(t[21]=e("p",{class:"text-sm text-destructive"},"Les demandes de réservation de plus d'une semaine restées sans réponse seront automatiquement annulées.",-1))]),e("div",Ne,[e("div",Re,[r(s(re),{class:"h-4 w-4"})]),t[22]||(t[22]=e("p",{class:"text-sm"},"Chaque demande faite à une organisation différente est traitée comme une réservation distincte.",-1))]),e("div",Be,[e("div",Qe,[r(s(ae),{class:"h-4 w-4"})]),t[23]||(t[23]=e("p",{class:"text-sm"},"La plateforme agit uniquement comme intermédiaire et ne peut être tenue responsable des litiges entre les parties.",-1))]),e("div",Je,[e("div",Ze,[r(s(le),{class:"h-4 w-4"})]),t[24]||(t[24]=e("p",{class:"text-sm"},"Il est de la responsabilité des utilisateurs de vérifier l'état et la conformité du matériel avant la location.",-1))]),e("div",Ge,[e("div",Ke,[r(s(ne),{class:"h-4 w-4"})]),t[25]||(t[25]=e("p",{class:"text-sm"},"La plateforme ne garantit pas la disponibilité des équipements et ne peut être tenue responsable des annulations.",-1))]),e("div",Oe,[e("div",We,[r(s(oe),{class:"h-4 w-4"})]),t[26]||(t[26]=e("p",{class:"text-sm"},"Les paiements et arrangements financiers se font directement avec les propriétaires des équipements, en dehors de la plateforme.",-1))])]),e("form",{class:"space-y-2",id:"reservation-message-form",onSubmit:R(E,["prevent"])},[t[27]||(t[27]=e("p",{class:"text-sm font-bold"},"Laissez un message pour présenter votre projet :",-1)),r(s(B),{modelValue:s(y).message,"onUpdate:modelValue":t[1]||(t[1]=o=>s(y).message=o),rows:"6",placeholder:"Présentez-vous, donnez du contexte, etc.",error:s(y).errors.message,required:""},null,8,["modelValue","error"])],32),r(s(K),null,{default:a(()=>[r(s(c),{variant:"outline",onClick:t[2]||(t[2]=o=>v.value=!1)},{default:a(()=>[...t[28]||(t[28]=[m(" Annuler ",-1)])]),_:1}),r(s(c),{type:"submit",form:"reservation-message-form",disabled:f.value},{default:a(()=>[...t[29]||(t[29]=[m(" Je confirme ma demande ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])]))])]),_:1}))}};export{zt as default};
